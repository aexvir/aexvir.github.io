<html>
<head>
	<meta charset="UTF-8">
	<meta name=viewport content="width=device-width, initial-scale=1">
	<meta name="expires" content="sat, 01 Jan 2050">
	<title>Alex Viscreanu</title>

	<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<script>window.jQuery || document.write('<script src="src/js/jquery.js">\x3C/script>')</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js"></script>
	<script>window.TweenMax || document.write('<script src="src/js/tweenmax.js">\x3C/script>')</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js"></script>

	<script src="static/js/modernizr.js"></script>

	<link rel="stylesheet" type="text/css" href="static/css/site.css">
	<link rel="stylesheet" type="text/css" href="static/fonts/FontAwesome/css/fontawesome.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gridlex/2.4.2/gridlex.min.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed" rel="stylesheet">
</head>
<body>
	<!-- Page menu -->
	<nav id="menu">
		<a class="directory active" href="javascript:;" data-dir="home">
			<div class="visible">Home</div>
			<div class="hidden">
				<i class="fa fa-home"></i>
			</div>
		</a>
		<a class="directory" id="brp" href="javascript:;" data-dir="about">
			<div class="visible">
				About me
			</div>
			<div class="hidden">
				<i class="fa fa-graduation-cap"></i>
			</div>
		</a>
		<div class="spacer"></div>
		<a class="directory" href="javascript:;" data-dir="portfolio">
			<div class="visible">
				Portfolio
			</div>
			<div class="hidden">
				<i class="fa fa-briefcase"></i>
			</div>
		</a>
		<a class="directory" href="javascript:;" data-dir="contact">
			<div class="visible">
				Contact
			</div>
			<div class="hidden">
				<i class="fa fa-envelope"></i>
			</div>
		</a>
	</nav>

	<div id="page-cover"></div>

	<div id="av-logo">
		<img src="static/img/web/logo.svg" alt="Alex Viscreanu">
	</div>

	<div id="page-container-wrapper">
		<div id="page-container" data-contains="home"></div>
	</div>

	<div id="home" class="page-content"></div>

	<div id="about" class="page-content">
		<div style="margin: 5rem; background: blue; height: 2000px;">ABOUT ME</div>
	</div>

	<div id="portfolio" class="page-content">
		<div class="container">
			<div class="wide segment main project element" data-content="aravolo.html" style="background-image: url(static/img/portfolio/aravolo/main.png)">
				<div class="title">aravolo</div>
			</div>
			<div class="responsive grid">
				<div class="col">
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
				    	<div class="title">Dummy title</div>
					</div>
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
                        <div class="title">Dummy title</div>
					</div>
				</div>
				<div class="col">
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
						<div class="title">Dummy title</div>
					</div>
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
                        <div class="title">Dummy title</div>
					</div>
				</div>
				<div class="col">
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
                        <div class="title">Dummy title</div>
					</div>
					<div class="wide segment project element" style="background-image: url(http://via.placeholder.com/1920x1080)">
                        <div class="title">Dummy title</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="contact" class="page-content">
		<div style="margin: 5rem; background: green;">CONTACT</div>
	</div>
	
	<div id="dynamic" class="page-content"></div>

	<script>
		TweenMax.set('#av-logo', {x: '-50%', y: '-50%', left: '50%', top: '50%'});
		TweenMax.to($('#av-logo img'), 4, {delay: 0.5, ease: Elastic.easeOut.config( 1.5, 0.25), rotationX: 0});
		TweenMax.to($('#menu'), .75, {delay: 0.5, ease: Power4.easeOut, top: 0, opacity: 1});
	</script>

	<script>
		var pageContainer = $('#page-container');
		function replacePageContent(page, fromHome) {
			TweenMax.to('#page-container', (fromHome ? 0 : .5), {ease: Power4.easeOut, y: '+=25', opacity: 0, onComplete: function () {
				pageContainer.html($('#' + page).html())
				TweenMax.to('#page-container', .5, {ease: Power4.easeOut, y: '-=25', opacity: 1});
			}});
		}
		function slideCoverUp(reverse, callback) {
			TweenMax.to($('#av-logo'), 1, {ease: Power4.easeOut, scale: (reverse ? 1 : 0.2), top: (reverse ? '50%' : '4%')});
			TweenMax.to($('#menu .spacer'), 1, {ease: Power4.easeOut, width: (reverse ? '0' : '100%')});
			TweenMax.to($('#page-cover'), 0.5, {y: (reverse ? '0%' : '-100%'), display: (reverse ? 'block' : 'none'), onComplete: callback});
			$('#av-logo').toggleClass('reduced', !reverse)
		}
		$(document).on('click', '.directory', function() {
			var clickedElement = $(this);
			var currentPage = pageContainer.attr('data-contains');
			var newPage = clickedElement.attr('data-dir');

			if(currentPage !== newPage) {
				if(currentPage === 'home') {
					slideCoverUp(false, function () {
						replacePageContent(newPage, true);
					});
				} else if (newPage === 'home') {
					replacePageContent(newPage);
					slideCoverUp(true);
				} else {
					replacePageContent(newPage);
				}
				pageContainer.attr('data-contains', newPage);
			}
		});
        $(document).on('click', '.project', function () {
            $('#dynamic').load('/static/html/' + $(this).attr('data-content'));
            replacePageContent('dynamic');
            pageContainer.attr('data-contains', 'dynamic');
		});

		$('#page-container').scroll(function(){
			window.requestAnimationFrame(scrollHero);
		});

		function scrollHero() {
			var scrollVar = $('#page-container').scrollTop().toFixed(2);
			if(scrollVar < 500) {
				var opacity = Math.max((100 - .5 * scrollVar)/100, 0);
				
				var menuStyling = {
					'background': 'rgba(35, 35, 35, ' + (1 - opacity - .15) + ')'
				}
				
				if (Modernizr.backdropfilter) {
					menuStyling = {
						'background': 'rgba(35, 35, 35, ' + (1 - opacity - .25) + ')',
						'backdrop-filter': 'blur(' + (scrollVar/50) + 'px)'
					}
				}

				$('#menu').css(menuStyling);
				console.log(opacity)
				$('.hero-header').css({
					'opacity': opacity
				});
			}
		}
	</script>
</body>
</html>
